<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"jiashun-ye.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":500,"width_dual_column":250,"display":"hide","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="本文对Facial Age Estimation by Learning from Label Distributions by Xin Geng, Kate Smith-Miles, Zhi-Hua Zhou进行精读，系统梳理其研究框架，并深入推导其中的数学模型。">
<meta property="og:type" content="article">
<meta property="og:title" content="精读解析|从单一标签到标签分布：面部年龄估计的新方法">
<meta property="og:url" content="http://jiashun-ye.github.io/2025/03/16/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90-%E4%BB%8E%E5%8D%95%E4%B8%80%E6%A0%87%E7%AD%BE%E5%88%B0%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%EF%BC%9A%E9%9D%A2%E9%83%A8%E5%B9%B4%E9%BE%84%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/index.html">
<meta property="og:site_name" content="JS.Ye’s Research Hub">
<meta property="og:description" content="本文对Facial Age Estimation by Learning from Label Distributions by Xin Geng, Kate Smith-Miles, Zhi-Hua Zhou进行精读，系统梳理其研究框架，并深入推导其中的数学模型。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://jiashun-ye.github.io/2025/03/16/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90-%E4%BB%8E%E5%8D%95%E4%B8%80%E6%A0%87%E7%AD%BE%E5%88%B0%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%EF%BC%9A%E9%9D%A2%E9%83%A8%E5%B9%B4%E9%BE%84%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83%E5%92%8C%E4%B8%89%E8%A7%92%E5%88%86%E5%B8%83.png">
<meta property="og:image" content="http://jiashun-ye.github.io/2025/03/16/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90-%E4%BB%8E%E5%8D%95%E4%B8%80%E6%A0%87%E7%AD%BE%E5%88%B0%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%EF%BC%9A%E9%9D%A2%E9%83%A8%E5%B9%B4%E9%BE%84%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/%E8%AE%AD%E7%BB%83%E9%98%B6%E6%AE%B5.png">
<meta property="og:image" content="http://jiashun-ye.github.io/2025/03/16/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90-%E4%BB%8E%E5%8D%95%E4%B8%80%E6%A0%87%E7%AD%BE%E5%88%B0%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%EF%BC%9A%E9%9D%A2%E9%83%A8%E5%B9%B4%E9%BE%84%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/%E9%A2%84%E6%B5%8B%E9%98%B6%E6%AE%B5.png">
<meta property="og:image" content="http://jiashun-ye.github.io/2025/03/16/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90-%E4%BB%8E%E5%8D%95%E4%B8%80%E6%A0%87%E7%AD%BE%E5%88%B0%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%EF%BC%9A%E9%9D%A2%E9%83%A8%E5%B9%B4%E9%BE%84%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/IIS-LLD%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B%E5%9B%BE.png">
<meta property="og:image" content="http://jiashun-ye.github.io/2025/03/16/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90-%E4%BB%8E%E5%8D%95%E4%B8%80%E6%A0%87%E7%AD%BE%E5%88%B0%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%EF%BC%9A%E9%9D%A2%E9%83%A8%E5%B9%B4%E9%BE%84%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/Age_Estimation_Results.png">
<meta property="og:image" content="http://jiashun-ye.github.io/2025/03/16/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90-%E4%BB%8E%E5%8D%95%E4%B8%80%E6%A0%87%E7%AD%BE%E5%88%B0%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%EF%BC%9A%E9%9D%A2%E9%83%A8%E5%B9%B4%E9%BE%84%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/deviation.png">
<meta property="og:image" content="http://jiashun-ye.github.io/2025/03/16/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90-%E4%BB%8E%E5%8D%95%E4%B8%80%E6%A0%87%E7%AD%BE%E5%88%B0%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%EF%BC%9A%E9%9D%A2%E9%83%A8%E5%B9%B4%E9%BE%84%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/MAE_in_Different_Age_Ranges.png">
<meta property="article:published_time" content="2025-03-16T12:12:50.000Z">
<meta property="article:modified_time" content="2025-03-18T05:48:00.190Z">
<meta property="article:author" content="Jiashun Ye">
<meta property="article:tag" content="标签分布学习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://jiashun-ye.github.io/2025/03/16/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90-%E4%BB%8E%E5%8D%95%E4%B8%80%E6%A0%87%E7%AD%BE%E5%88%B0%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%EF%BC%9A%E9%9D%A2%E9%83%A8%E5%B9%B4%E9%BE%84%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/%E9%AB%98%E6%96%AF%E5%88%86%E5%B8%83%E5%92%8C%E4%B8%89%E8%A7%92%E5%88%86%E5%B8%83.png">


<link rel="canonical" href="http://jiashun-ye.github.io/2025/03/16/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90-%E4%BB%8E%E5%8D%95%E4%B8%80%E6%A0%87%E7%AD%BE%E5%88%B0%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%EF%BC%9A%E9%9D%A2%E9%83%A8%E5%B9%B4%E9%BE%84%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://jiashun-ye.github.io/2025/03/16/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90-%E4%BB%8E%E5%8D%95%E4%B8%80%E6%A0%87%E7%AD%BE%E5%88%B0%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%EF%BC%9A%E9%9D%A2%E9%83%A8%E5%B9%B4%E9%BE%84%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/","path":"2025/03/16/精读解析-从单一标签到标签分布：面部年龄估计的新方法/","title":"精读解析|从单一标签到标签分布：面部年龄估计的新方法"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>精读解析|从单一标签到标签分布：面部年龄估计的新方法 | JS.Ye’s Research Hub</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="JS.Ye’s Research Hub" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">JS.Ye’s Research Hub</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记录论文精读与拓展、课程学习笔记及研究项目全过程</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83"><span class="nav-number">1.</span> <span class="nav-text">定义标签分布</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%E6%A8%A1%E5%9E%8B%E4%B8%8E%E5%AD%A6%E4%B9%A0%E6%96%B9%E5%BC%8F"><span class="nav-number">2.</span> <span class="nav-text">标签分布模型与学习方式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%98%E5%8C%96%E7%9B%AE%E6%A0%87kl%E6%95%A3%E5%BA%A6"><span class="nav-number">2.1.</span> <span class="nav-text">优化目标：KL散度</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E6%A6%82%E7%8E%87%E5%BD%A2%E5%BC%8F%E6%9C%80%E5%A4%A7%E7%86%B5%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.2.</span> <span class="nav-text">条件概率形式：最大熵模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E5%A4%A7%E7%86%B5%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.2.1.</span> <span class="nav-text">最大熵模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E6%9E%90%E8%A7%A3%E7%90%86%E8%AE%BA%E6%8E%A8%E5%AF%BC"><span class="nav-number">2.2.2.</span> <span class="nav-text">解析解理论推导</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95iis-lld"><span class="nav-number">2.3.</span> <span class="nav-text">优化算法：IIS-LLD</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E6%A0%87%E5%87%BD%E6%95%B0"><span class="nav-number">2.3.1.</span> <span class="nav-text">目标函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%AE%E6%A0%87%E5%87%BD%E6%95%B0%E5%A2%9E%E9%87%8F%E4%B8%8B%E7%95%8C%E6%8E%A8%E5%AF%BC"><span class="nav-number">2.3.2.</span> <span class="nav-text">目标函数增量下界推导</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#iis-lld%E7%AE%97%E6%B3%95"><span class="nav-number">2.3.3.</span> <span class="nav-text">IIS-LLD算法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E5%92%8C%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90"><span class="nav-number">3.</span> <span class="nav-text">实验和结果分析</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jiashun Ye"
      src="/images/%E7%89%A1%E4%B8%B9%E4%BA%AD%E5%A4%B4%E5%83%8F.jpg">
  <p class="site-author-name" itemprop="name">Jiashun Ye</p>
  <div class="site-description" itemprop="description">机器学习、模式识别与计算机视觉是我的核心研究领域。目前我主修数学，辅修计算机科学，并在课余自主学习物理和高性能计算。我致力于人工智能领域的数学理论发展，关注如何利用物理直觉设计和优化算法。此外，我重视计算能力的提升，包括分布式模型训练以及训练和推理过程的性能优化和加速。</div>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://jiashun-ye.github.io/2025/03/16/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90-%E4%BB%8E%E5%8D%95%E4%B8%80%E6%A0%87%E7%AD%BE%E5%88%B0%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%EF%BC%9A%E9%9D%A2%E9%83%A8%E5%B9%B4%E9%BE%84%E4%BC%B0%E8%AE%A1%E7%9A%84%E6%96%B0%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E7%89%A1%E4%B8%B9%E4%BA%AD%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="Jiashun Ye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JS.Ye’s Research Hub">
      <meta itemprop="description" content="机器学习、模式识别与计算机视觉是我的核心研究领域。目前我主修数学，辅修计算机科学，并在课余自主学习物理和高性能计算。我致力于人工智能领域的数学理论发展，关注如何利用物理直觉设计和优化算法。此外，我重视计算能力的提升，包括分布式模型训练以及训练和推理过程的性能优化和加速。">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="精读解析|从单一标签到标签分布：面部年龄估计的新方法 | JS.Ye’s Research Hub">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          精读解析|从单一标签到标签分布：面部年龄估计的新方法
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-03-16 20:12:50" itemprop="dateCreated datePublished" datetime="2025-03-16T20:12:50+08:00">2025-03-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-18 13:48:00" itemprop="dateModified" datetime="2025-03-18T13:48:00+08:00">2025-03-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%BA%E6%96%87%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">论文学习</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%BA%E6%96%87%E5%AD%A6%E4%B9%A0/%E7%B2%BE%E8%AF%BB%E8%A7%A3%E6%9E%90/" itemprop="url" rel="index"><span itemprop="name">精读解析</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>本文对<em>Facial Age Estimation by Learning from Label
Distributions</em> by Xin Geng, Kate Smith-Miles, Zhi-Hua
Zhou进行精读，系统梳理其研究框架，并深入推导其中的数学模型。</p>
<span id="more"></span>
<p>面部年龄估计面临数据稀疏性挑战（如高龄段样本不足）。受到年龄变化具有连续性（相邻年龄特征相似）启发，Xin
Geng提出<em>标签分布学习</em>框架：将单一年龄标签扩展为覆盖邻近年龄的分布，通过共享年龄特征缓解数据不足，显著提升模型泛化能力，尤其是高龄的准确度。</p>
<h1 id="定义标签分布">定义标签分布</h1>
<p>标签分布是单标签和多标签的一个拓广，并且标签分布的含义和概率或者模糊分类不同，不过在数学结构上与概率高度相似。标签分布的核心概念是，每个标签都是对样本的正确描述，但描述程度不同，所有标签的组合构成对样本的完整描述。相比传统的单标签学习，这种方法能更好地反映类别之间的相关性，特别适用于年龄估计这样的连续变量任务。</p>
<p>设<span class="math inline">\(\alpha\)</span>是原始标签，<span
class="math inline">\(y\)</span>是一般标签，从单标签转换为标签分布需要遵循两个基本原则：</p>
<ul>
<li><p>原始标签的描述程度最大，即 <span
class="math inline">\(P(\alpha)\)</span> 应该是分布中的最大值。</p></li>
<li><p>距离原始标签越远的标签，其描述程度越低，即 <span
class="math inline">\(P(y)\)</span> 随 <span class="math inline">\(|y -
\alpha|\)</span> 的增加而递减。</p></li>
</ul>
<p>论文里使用的标签分布有以下两种：</p>
<p><img src="高斯分布和三角分布.png" /></p>
<p><u><em>高斯分布（Gaussian
Distribution）</em></u>，通过指数衰减方式平滑地降低相邻标签的权重，定义如下：
<span class="math display">\[
P(y) = \frac{1}{Z} \exp \left(-\frac{(y - \alpha)^2}{2\sigma^2} \right)
\]</span></p>
<p>其中，<span class="math inline">\(Z\)</span> 是归一化因子，<span
class="math inline">\(\sigma\)</span>
控制分布的扩展范围。高斯分布能够较好地利用相邻标签信息，确保模型对年龄变化的连续性建模。</p>
<p><u><em>三角分布（Triangle
Distribution）</em></u>，采用线性递减的方式，仅在一定范围内赋予相邻标签权重：
<span class="math display">\[
P(y) = \max \left(0, 1 - \frac{|y - \alpha|}{l} \right)
\]</span></p>
<p>其中，<span class="math inline">\(l\)</span>
决定了分布的跨度。相比高斯分布，三角分布更加局部化，确保远离原始标签的标签不会对模型产生影响。</p>
<h1 id="标签分布模型与学习方式">标签分布模型与学习方式</h1>
<p>以下是签分布学习的建模与优化方法的基本结构：</p>
<p><img src="训练阶段.png" /></p>
<p><img src="预测阶段.png" /></p>
<h2 id="优化目标kl散度">优化目标：KL散度</h2>
设输入空间为 $ \mathcal{X} = \mathbb{R}^d $，标签空间为 $ \mathcal{Y} = \{ y_1, y_2, \dots, y_c \} $。传统分类任务中，每个样本 $ x_i $ 仅对应一个标签，但在标签分布学习中，每个样本 $ x_i $ 关联一个 标签分布 $ P_i(y) $，表示该样本在不同标签上的分布权重。

目标是学习一个条件概率分布 $ p(y|x; \theta) $，使其尽可能接近 $ P_i(y) $。采用 KL散度 作为衡量准则：
<p><span class="math display">\[
\theta^* = \arg\min_{\theta} \sum_i \sum_y P_i(y) \log
\frac{P_i(y)}{p(y|x_i; \theta)}
\]</span></p>
<p>由于 <span class="math inline">\(P_i(y)\)</span>
在训练样本里是常数，KL 散度最小化等价于 <em>最大化对数似然（MLE）</em>：
<span class="math display">\[
\theta^* = \arg\max_{\theta} \sum_i \sum_y P_i(y) \log p(y|x_i; \theta)
\]</span>
标签分布学习框架与传统问题在以KL散度为目标函数的情况下具有密切联系：</p>
<ul>
<li>在单标签分类任务中，每个样本仅有一个确定的标签，即 $ P_i(y) = \delta(y, y_i) $。目标函数退化为经典的最大似然估计目标：</li>
</ul>
<p><span class="math display">\[
\theta^* = \arg\max_{\theta} \sum_i \log p(y_i | x_i; \theta)
\]</span></p>
<ul>
<li>在多标签分类任务中，每个样本 $ x_i $ 关联一个标签集合 $ Y_i $，假设
$ P_i(y) $
均匀分布在多个标签上。目标函数变为熵权重标签分配方法，将多标签样本转化为带权重的单标签样本，并优化最大似然目标：</li>
</ul>
<p><span class="math display">\[
\theta^* = \arg\max_{\theta} \sum_i \frac{1}{|Y_i|} \sum_{y \in Y_i}
\log p(y | x_i; \theta)
\]</span></p>
<h2 id="条件概率形式最大熵模型">条件概率形式：最大熵模型</h2>
<h3 id="最大熵模型">最大熵模型</h3>
<p>确定了条件概率函数的形式，才能进行参数的调整实现KL散度的优化。论文采用了最大熵模型得到条件概率函数，该模型也是一个优化问题。目标函数是最大化熵，即在符合约束条件的前提下，使得条件分布 $ p(y|x; \theta) $ 尽可能均匀，包含最多的信息，避免引入额外的假设，从而提高模型的泛化能力。
$$
\max_{p(y|x; \theta)}  \sum_{x,y} \tilde{p}(x) p(y|x; \theta) \log p(y|x; \theta)
$$

其中，$p(y|x; \theta)$为给定输入 $ x $ 的条件概率分布，是需要优化的目标分布； $ \tilde{p}(x,y) $是经验联合分布，由训练数据估计得到；  $ \tilde{p}(x) $是经验边际分布，即 $ \tilde{p}(x) = \sum_y \tilde{p}(x,y) $； $ f_k(x,y) $为特征函数，表示输入 $ x $ 和类别 $ y $ 之间的某种特征； $ \theta $为模型参数，决定了条件概率分布的形状。</p>
<p>最大熵模型有两个约束条件：</p>
<ul>
<li>特征函数的期望值约束，要求模型的特征函数期望值与训练数据保持一致：</li>
</ul>
<p><span class="math display">\[
\sum_{x,y} \tilde{p}(x,y) f_k(x,y) = \sum_{x,y} \tilde{p}(x) p(y|x;
\theta) f_k(x,y), \quad \forall k.
\]</span></p>
<ul>
<li>概率归一化约束，确保 $ p(y|x; ) $ 是一个合法的概率分布：</li>
</ul>
<p><span class="math display">\[
\sum_y p(y|x; \theta) = 1, \quad \forall x.
\]</span>
<em>特征函数会让人觉得很突兀，可以这样理解：如果特征函数表示图片中面部的皱纹数量，那么训练出的模型在期望意义上会在皱纹数量上尽可能贴合训练样本。论文里特征函数由特征提取器提供，它是一个黑盒，虽然无法直接解释其数值，但一个优秀的特征提取器会输出与目标（如年龄预测）高度相关的特征，因此这个约束可以让模型在这些预测相关的特征上进行最优拟合。</em></p>
<p>这个优化问题有一个解析解： <span class="math display">\[
p(y|x; \theta) = \frac{1}{Z} \exp\left( \sum_k \theta_k f_k(x,y)
\right),
\]</span></p>
<p>其中</p>
<p><span class="math display">\[
Z = \sum_y \exp\left( \sum_k \theta_k f_k(x,y) \right).
\]</span></p>
<h3 id="解析解理论推导">解析解理论推导</h3>
<h2 id="优化算法iis-lld">优化算法：IIS-LLD</h2>
<h3 id="目标函数">目标函数</h3>
<p>将得到的指数型条件概率函数代入KL散度式子得到： <span
class="math display">\[
T(\theta) = \sum_{i} \sum_{y} P_i(y) \log \left( \frac{1}{Z(x_i)} \exp
\left( \sum_k \theta_{y,k} g_k(x_i) \right) \right)
\]</span> 展开对数： <span class="math display">\[
T(\theta) = \sum_{i} \sum_{y} P_i(y) \sum_k \theta_{y,k} g_k(x_i) -
\sum_i \sum_{y} P_i(y) \log Z(x_i)
\]</span></p>
<p>由于 <span class="math inline">\(Z(x_i)\)</span> 与 <span
class="math inline">\(y\)</span> 无关，且 <span
class="math inline">\(P_i(y)\)</span> 对 <span
class="math inline">\(y\)</span> 求和为 1： <span
class="math display">\[
\sum_{y} P_i(y) \log Z(x_i) = \log Z(x_i) \sum_y P_i(y) = \log Z(x_i)
\]</span> 故 <span class="math display">\[
T(\theta) = \sum_{i} \sum_{y} P_i(y) \sum_k \theta_{y,k} g_k(x_i) -
\sum_i \log Z(x_i)
\]</span> 展开 <span class="math inline">\(Z(x_i)\)</span> ：</p>
<p><span class="math display">\[
T(\theta) = \sum_{i} \sum_{y} P_i(y) \sum_k \theta_{y,k} g_k(x_i) -
\sum_i \log \sum_y \exp \left( \sum_k \theta_{y,k} g_k(x_i) \right)
\]</span></p>
<h3 id="目标函数增量下界推导">目标函数增量下界推导</h3>
<p>我们希望最大化目标函数： <span class="math display">\[
T(\theta) = \sum_{i,y} P_i(y) \sum_k \theta_{y,k} g_k(x_i) - \sum_i \log
Z(x_i)
\]</span> 其中： <span class="math display">\[
Z(x_i) = \sum_y \exp \left( \sum_k \theta_{y,k} g_k(x_i) \right)
\]</span></p>
<p>定义参数更新： <span class="math display">\[
\theta^{(t+1)} = \theta^{(t)} + \Delta
\]</span> 其中增量： <span class="math display">\[
\delta_{y,k} = \theta_{y,k}^{(t+1)} - \theta_{y,k}^{(t)}
\]</span></p>
<p>增量后的归一化因子： <span class="math display">\[
Z^*(x_i) = \sum_y \exp \left( \sum_k (\theta_{y,k} + \delta_{y,k})
g_k(x_i) \right)
\]</span></p>
<p>目标函数增量： <span class="math display">\[
T(\theta + \Delta) - T(\theta) =
\sum_{i,y} P_i(y) \sum_k \delta_{y,k} g_k(x_i) - \sum_i \log
\frac{Z^*(x_i)}{Z(x_i)}
\]</span></p>
<p>计算后一项： <span class="math display">\[
\frac{Z^*(x_i)}{Z(x_i)} = \frac{\sum_y \exp \left( \sum_k (\theta_{y,k}
+ \delta_{y,k}) g_k(x_i) \right)}
{\sum_y \exp \left( \sum_k \theta_{y,k} g_k(x_i) \right)}
\]</span></p>
<p>提取原归一化项： <span class="math display">\[
\frac{Z^*(x_i)}{Z(x_i)} =
\sum_y \frac{\exp \left( \sum_k \theta_{y,k} g_k(x_i) \right)}{Z(x_i)}
\exp \left( \sum_k \delta_{y,k} g_k(x_i) \right)
\]</span></p>
<p>由于： <span class="math display">\[
p(y | x_i; \theta) = \frac{\exp \left( \sum_k \theta_{y,k} g_k(x_i)
\right)}{Z(x_i)}
\]</span></p>
<p>所以： <span class="math display">\[
\frac{Z^*(x_i)}{Z(x_i)} = \sum_y p(y | x_i; \theta) \exp \left( \sum_k
\delta_{y,k} g_k(x_i) \right)
\]</span></p>
<p>使用对数不等式放缩： <span class="math display">\[
-\log x \geq 1 - x
\]</span></p>
<p>应用到目标函数增量： <span class="math display">\[
-\sum_i \log \sum_y p(y | x_i; \theta) \exp \left( \sum_k \delta_{y,k}
g_k(x_i) \right)
\geq
\sum_i \left( 1 - \sum_y p(y | x_i; \theta) \exp \left( \sum_k
\delta_{y,k} g_k(x_i) \right) \right)
\]</span></p>
<p>故 <span class="math display">\[
T(\theta + \Delta) - T(\theta) \geq
\sum_{i,y} P_i(y) \sum_k \delta_{y,k} g_k(x_i) + n - \sum_i \sum_y p(y |
x_i; \theta) \exp \left( \sum_k \delta_{y,k} g_k(x_i) \right)
\]</span></p>
<p>下面使用 Jensen不等式 继续放缩，</p>
<p>定义： <span class="math display">\[
g^\#(x_i) = \sum_k |g_k(x_i)|
\]</span></p>
<p>由于指数函数是凸函数，根据 Jensen不等式，令 $ s(g_k(x_i)) $ 为 $
g_k(x_i) $ 的符号函数： <span class="math display">\[
\sum_k \frac{|g_k(x_i)|}{g^\#(x_i)} \exp \left( \delta_{y,k} s(g_k(x_i))
g^\#(x_i) \right)
\geq
\exp \left( \sum_k \frac{|g_k(x_i)|}{g^\#(x_i)} \delta_{y,k} g^\#(x_i)
\right)
\]</span></p>
<p>即 <span class="math display">\[
\sum_k \frac{|g_k(x_i)|}{g^\#(x_i)} \exp \left( \delta_{y,k} s(g_k(x_i))
g^\#(x_i) \right)
\geq
\exp \left( \sum_k \delta_{y,k} |g_k(x_i)| \right)
\]</span></p>
<p>调换方向： <span class="math display">\[
-\exp \left( \sum_k \delta_{y,k} |g_k(x_i)| \right)
\geq
-\sum_k \frac{|g_k(x_i)|}{g^\#(x_i)} \exp \left( \delta_{y,k}
s(g_k(x_i)) g^\#(x_i) \right)
\]</span></p>
<p>代入前面的下界： <span class="math display">\[
T(\theta + \Delta) - T(\theta) \geq
\sum_{i,y} P_i(y) \sum_k \delta_{y,k} g_k(x_i) + n - \sum_{i, y} p(y |
x_i; \theta)\sum_k \frac{|g_k(x_i)|}{g^\#(x_i)} \exp \left( \delta_{y,k}
s(g_k(x_i)) g^\#(x_i) \right)
\]</span></p>
<p>我们将右侧表达式定义为： <span class="math display">\[
\mathcal{A}(\Delta | \theta) =
\sum_{i,y} P_i(y) \sum_k \delta_{y,k} g_k(x_i) + n - \sum_{i, y} p(y |
x_i; \theta)\sum_k \frac{|g_k(x_i)|}{g^\#(x_i)} \exp \left( \delta_{y,k}
s(g_k(x_i)) g^\#(x_i) \right)
\]</span></p>
<p>即 <span class="math display">\[
T(\theta + \Delta) - T(\theta) \geq \mathcal{A}(\Delta | \theta)
\]</span></p>
<h3 id="iis-lld算法">IIS-LLD算法</h3>
<p><span class="math inline">\(T(\theta)\)</span> 通过 Jensen 不等式
的放缩，使得<span class="math inline">\(\mathcal{A}(\Delta |
\theta)\)</span> 各个维度变得相互独立，可以逐个维度独立优化。</p>
<p>优化过程即对 <span class="math inline">\(\mathcal{A}(\Delta |
\theta)\)</span> 求导，并令梯度为 0，得到每个维度的增量：</p>
<p><span class="math display">\[
\frac{\partial \mathcal{A}(\Delta | \theta)}{\partial \delta_{y,k}} =
\sum_{i} P_i(y) g_k(x_i) - \sum_{i} p(y | x_i; \theta) g_k(x_i)
\exp(\delta_{y,k} s(g_k(x_i)) g^\#(x_i)) = 0.
\]</span></p>
<p>此方程可以通过数值方法（如 Gauss-Newton 方法）逐个求解每个维度的增量
<span
class="math inline">\(\delta_{y,k}\)</span>，最终完成迭代更新。算法流程如下：</p>
<p><img src="IIS-LLD算法流程图.png" /></p>
<p><em>经典的IIS算法要求特征函数非负，论文里为了保证标签分布模型的灵活性，取消了这一限制，所以命名为IIS-LLD算法。从算法上来看也能得到最后的解，不过从数值方法的角度来看，这会带来不稳定的风险。</em></p>
<h1 id="实验和结果分析">实验和结果分析</h1>
<p>实验使用了 <em>FG-NET Aging Database</em>，该数据集包含1002
张面部图像，来自82 名受试者，年龄范围在0-69
岁之间。每名受试者的照片数量在6-18
张之间，数据集中包含不同的光照、表情和姿态变化。由于年龄较大的样本较少，研究者采用了
<em>Leave-One-Person-Out（LOPO）交叉验证</em>，即每次选取一名受试者的所有照片作为测试集，其余受试者的照片作为训练集，重复82
轮计算最终结果。实验使用 <em>Mean Absolute Error（MAE）</em>
作为误差度量，计算预测年龄与真实年龄之间的平均绝对误差。</p>
<p>特征提取方法基于 <em>外观模型（Appearance
Model）</em>。该模型首先模型检测人脸关键点，通过
<em>PCA（主成分分析）</em>
对关键点坐标进行降维；然后对人脸图像进行标准化，使其符合统一的形状；再对标准化后的灰度图进行PCA
降维，提取纹理特征；最终形状和纹理特征被结合成一个特征向量。在 PCA
降维过程中，研究者选择保留95% 的数据变异性，截取了前200个主成分。</p>
<p>以下是实验中用到的方法和对应的关键参数：</p>
<table>
<colgroup>
<col style="width: 26%" />
<col style="width: 73%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">方法</th>
<th style="text-align: center;">关键参数</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">IIS-LLD (Gaussian)</td>
<td style="text-align: center;">高斯分布，标准差 ( = 1 )</td>
</tr>
<tr class="even">
<td style="text-align: center;">IIS-LLD (Triangle)</td>
<td style="text-align: center;">三角分布，底边长度 ( l = 6 )</td>
</tr>
<tr class="odd">
<td style="text-align: center;">IIS-LLD (Single)</td>
<td style="text-align: center;">传统单标签，仅用真实年龄</td>
</tr>
<tr class="even">
<td style="text-align: center;">AGES</td>
<td style="text-align: center;">老化模式子空间维度 = 20</td>
</tr>
<tr class="odd">
<td style="text-align: center;">WAS</td>
<td style="text-align: center;">不需要设置参数</td>
</tr>
<tr class="even">
<td style="text-align: center;">AAS</td>
<td style="text-align: center;">误差阈值 = 3，年龄段 = (0-9, 10-19,
20-39, 40-69)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">KNN</td>
<td style="text-align: center;">邻近样本数 ( K = 30 )</td>
</tr>
<tr class="even">
<td style="text-align: center;">BP (神经网络)</td>
<td style="text-align: center;">隐藏层神经元 = 100</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C4.5 (决策树)</td>
<td style="text-align: center;">使用 J4.8 版本，默认参数</td>
</tr>
<tr class="even">
<td style="text-align: center;">SVM</td>
<td style="text-align: center;">核函数：RBF，核宽度 = 1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">HumanA (灰度图像)</td>
<td style="text-align: center;">仅展示去除背景的灰度脸部图像</td>
</tr>
<tr class="even">
<td style="text-align: center;">HumanB (彩色图像)</td>
<td
style="text-align: center;">展示完整的彩色图像，包括头发、服饰、背景等</td>
</tr>
</tbody>
</table>
<p>实验结果如下所示，表现优于HumanA使用紫色柱形，优于HumanB加上竖直虚线：</p>
<p><img src="Age_Estimation_Results.png" /></p>
<p><em>从图中可以看出来，即使没有使用标签分布，IIS-LLD算法表现已经十分优秀，这得益于最大熵模型的良好性质，标签分布达到了锦上添花的效果，使得算法性能超过HumanB。高斯分布覆盖了所有年龄，而三角分布只覆盖了临近的年龄，单标签只覆盖本身的年龄，它们的表现优度依次递减。</em></p>
<p>论文还对两种标签分布的参数<span
class="math inline">\(\sigma\)</span>、<span
class="math inline">\(l\)</span>进行了调整，测试对应的MAE，结果如下：</p>
<p><img src="deviation.png" /></p>
<p><em>参数越大，意味着分布约分散。两个分布的参数为0时，都退化为单标签。在临近标签对真实标签做贡献但又不至于“喧宾夺主”间需要保持平衡，才能达到最好的效果。</em></p>
<p>接下来是对三种IIS-LLD算法和baseline中表现最好的AGES模型在各个年龄段内的MAE做可视化，n表示该年龄段内的样本数量。</p>
<p><img src="MAE_in_Different_Age_Ranges.png" /></p>
<p><em>在数据丰富低年龄段内，IIS-LLD模型稍逊于专门做面部年龄估计的AGES模型；而在数据稀疏的高年龄段内IIS-LLD模型明显优于AGES模型。这验证了论文用标签分布弥补数据不足缺陷的想法。</em></p>
<p>作者最后给出了标签分布存在应用价值的三个场景，帮助处理标签不确定性和数据稀缺问题：实例初始标签即为类分布；类之间存在强相关性；不同来源的标签存在争议。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%A0%87%E7%AD%BE%E5%88%86%E5%B8%83%E5%AD%A6%E4%B9%A0/" rel="tag"># 标签分布学习</a>
          </div>

        

    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Jiashun Ye</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.min.js","integrity":"sha256-G8ouPAnw4zzMbnAenHnVz6h9XpKbNdOkrqTh7AadyHs="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
